Experiments failed after 0.07 hours
Error: Command '['python', 'main_experiments.py']' returned non-zero exit status 1.
Output: 2025-08-11 03:23:09,236 - INFO - ============================================================
2025-08-11 03:23:09,236 - INFO - STARTING 4Ã— A5000 PARALLEL EXPERIMENTS
2025-08-11 03:23:09,236 - INFO - Start time: 2025-08-11 03:23:09.236241
2025-08-11 03:23:09,236 - INFO - ============================================================
============================================================
STARTING 4Ã— A5000 PARALLEL EXPERIMENTS
============================================================
2025-08-11 03:23:09,236 - INFO - Starting Experiment 1: Positive Controls

============================================================
EXPERIMENT 1: POSITIVE CONTROLS (Parallel on 4 GPUs)
============================================================
2025-08-11 03:23:18,317 - INFO - GPU 2: Starting positive control test for ioi
GPU 2: Testing ioi
2025-08-11 03:23:19,213 - INFO - GPU 1: Starting positive control test for arithmetic
2025-08-11 03:23:19,304 - INFO - GPU 3: Starting positive control test for river
GPU 1: Testing arithmetic
2025-08-11 03:23:19,334 - INFO - GPU 0: Starting positive control test for counting
GPU 3: Testing river
GPU 0: Testing counting
2025-08-11 03:23:31,740 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:23:37,414 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:23:40,912 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:23:41,348 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:23:41,384 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:23:46,660 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:23:47,193 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:23:47,297 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 2
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 1
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 0
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 3
âœ“ Positive controls complete

2025-08-11 03:24:10,077 - INFO - Experiment 1 completed in 1.0 minutes
2025-08-11 03:24:10,077 - INFO - Starting Experiment 2: Causal Tracing

============================================================
EXPERIMENT 2: CAUSAL TRACING (Parallel on 4 GPUs)
============================================================
2025-08-11 03:24:19,069 - INFO - GPU 1: Starting causal tracing for layers 8-15
2025-08-11 03:24:19,073 - INFO - GPU 2: Starting causal tracing for layers 16-23
GPU 1: Tracing layers 8-15
GPU 2: Tracing layers 16-23
2025-08-11 03:24:19,292 - INFO - GPU 3: Starting causal tracing for layers 24-31
2025-08-11 03:24:19,321 - INFO - GPU 0: Starting causal tracing for layers 0-7
GPU 3: Tracing layers 24-31
GPU 0: Tracing layers 0-7
2025-08-11 03:24:41,429 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:24:41,518 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:24:42,092 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:24:42,127 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:24:48,647 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:24:48,706 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:24:49,343 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:24:49,359 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 1
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 2
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 3
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 0
âœ“ Causal tracing complete

2025-08-11 03:25:25,053 - INFO - Experiment 2 completed in 1.2 minutes
2025-08-11 03:25:25,054 - INFO - Starting Experiment 3: Phase Transition

============================================================
EXPERIMENT 3: PHASE TRANSITION (200 points on 4 GPUs)
============================================================
2025-08-11 03:25:34,385 - INFO - GPU 1: Starting ablation sweep with 50 values
GPU 1: Testing 50 ablation values
2025-08-11 03:25:34,794 - INFO - GPU 0: Starting ablation sweep with 50 values
2025-08-11 03:25:34,805 - INFO - GPU 3: Starting ablation sweep with 50 values
2025-08-11 03:25:34,817 - INFO - GPU 2: Starting ablation sweep with 50 values
GPU 0: Testing 50 ablation values
GPU 3: Testing 50 ablation values
GPU 2: Testing 50 ablation values
2025-08-11 03:25:53,143 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:25:57,070 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:25:57,380 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:25:57,502 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:26:00,219 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:26:03,836 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:26:03,914 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:26:04,051 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 1
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 2
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 0
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 3
âœ“ Phase transition analysis complete

2025-08-11 03:26:27,614 - INFO - Experiment 3 completed in 1.0 minutes
2025-08-11 03:26:27,614 - INFO - Starting Experiment 4: Path Patching

============================================================
EXPERIMENT 4: PATH PATCHING (Parallel on 4 GPUs)
============================================================
2025-08-11 03:26:36,486 - INFO - GPU 0: Starting path patching for layers [7, 8, 9]
2025-08-11 03:26:36,502 - INFO - GPU 2: Starting path patching for layers [28, 29]
2025-08-11 03:26:36,513 - INFO - GPU 3: Starting path patching for layers [30, 31]
2025-08-11 03:26:36,614 - INFO - GPU 1: Starting path patching for layers [13, 14, 15]
2025-08-11 03:26:59,505 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:26:59,559 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:26:59,574 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:26:59,712 - WARNING - With reduced precision, it is advised to use `from_pretrained_no_processing` instead of `from_pretrained`.
2025-08-11 03:27:06,793 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:27:06,906 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:27:06,973 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
2025-08-11 03:27:07,057 - WARNING - You are not using LayerNorm, so the writing weights can't be centered! Skipping
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 1
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 0
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 2
Loaded pretrained model meta-llama/Llama-3.1-8B-Instruct into HookedTransformer
âœ“ Model loaded on GPU 3
âœ“ Path patching complete

2025-08-11 03:27:30,626 - INFO - Experiment 4 completed in 1.1 minutes
2025-08-11 03:27:30,626 - INFO - ============================================================
2025-08-11 03:27:30,626 - INFO - ALL EXPERIMENTS COMPLETE!
2025-08-11 03:27:30,626 - INFO - Total runtime: 0.07 hours
2025-08-11 03:27:30,626 - INFO - Estimated cost: $0.40
2025-08-11 03:27:30,626 - INFO - End time: 2025-08-11 03:27:30.626619
2025-08-11 03:27:30,626 - INFO - ============================================================
============================================================
ALL EXPERIMENTS COMPLETE!
Total runtime: 0.07 hours
Estimated cost: $0.40
============================================================

Error Output: /home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
2025-08-11 03:23:07.097942: I tensorflow/core/util/util.cc:169] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:01<00:04,  1.58s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.44s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.47s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.51s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:05<00:05,  2.88s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.83s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.78s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.81s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:09<00:03,  3.47s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:10<00:00,  2.41s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:10<00:00,  2.58s/it]

Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.52s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.59s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.54s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.31s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.79s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.32s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.80s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.36s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.83s/it]

  0%|          | 0/20 [00:00<?, ?it/s]
  5%|â–Œ         | 1/20 [00:00<00:09,  2.10it/s]
 15%|â–ˆâ–Œ        | 3/20 [00:00<00:02,  5.85it/s]
 30%|â–ˆâ–ˆâ–ˆ       | 6/20 [00:00<00:01, 10.96it/s]
 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 9/20 [00:00<00:00, 14.75it/s]
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:00<00:00, 17.53it/s]
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 15/20 [00:01<00:00, 19.54it/s]
 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 18/20 [00:01<00:00, 20.97it/s]
 95%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ| 19/20 [00:01<00:00, 14.60it/s]
Process Process-4:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 74, in run_positive_control
    text_before = model.to_string(output_before[0])
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 845, in to_string
    tokens = torch.tensor(tokens)
TypeError: new(): invalid data type 'str'

  0%|          | 0/20 [00:00<?, ?it/s]
  0%|          | 0/20 [00:00<?, ?it/s]
  0%|          | 0/20 [00:00<?, ?it/s]
  5%|â–Œ         | 1/20 [00:00<00:07,  2.42it/s]
  5%|â–Œ         | 1/20 [00:00<00:07,  2.65it/s]
  5%|â–Œ         | 1/20 [00:00<00:07,  2.56it/s]
 15%|â–ˆâ–Œ        | 3/20 [00:00<00:02,  6.84it/s]
 15%|â–ˆâ–Œ        | 3/20 [00:00<00:02,  7.20it/s]
 15%|â–ˆâ–Œ        | 3/20 [00:00<00:02,  6.99it/s]
 30%|â–ˆâ–ˆâ–ˆ       | 6/20 [00:00<00:01, 12.24it/s]
 30%|â–ˆâ–ˆâ–ˆ       | 6/20 [00:00<00:01, 12.70it/s]
 30%|â–ˆâ–ˆâ–ˆ       | 6/20 [00:00<00:01, 12.44it/s]
 40%|â–ˆâ–ˆâ–ˆâ–ˆ      | 8/20 [00:00<00:01, 10.46it/s]
Process Process-3:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 74, in run_positive_control
    text_before = model.to_string(output_before[0])
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 845, in to_string
    tokens = torch.tensor(tokens)
TypeError: new(): invalid data type 'str'

 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 9/20 [00:00<00:00, 16.38it/s]
 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 9/20 [00:00<00:00, 16.13it/s]
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:00<00:00, 18.90it/s]
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:00<00:00, 18.65it/s]
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 15/20 [00:00<00:00, 20.63it/s]
 75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 15/20 [00:00<00:00, 20.38it/s]
 80%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  | 16/20 [00:01<00:00, 15.11it/s]
Process Process-2:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 74, in run_positive_control
    text_before = model.to_string(output_before[0])
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 845, in to_string
    tokens = torch.tensor(tokens)
TypeError: new(): invalid data type 'str'

 90%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ | 18/20 [00:01<00:00, 21.57it/s]
100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 20/20 [00:01<00:00, 16.65it/s]
Process Process-5:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 74, in run_positive_control
    text_before = model.to_string(output_before[0])
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 845, in to_string
    tokens = torch.tensor(tokens)
TypeError: new(): invalid data type 'str'
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.43s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.46s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.44s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.53s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.72s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.74s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.80s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.78s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.71s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.73s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.41s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.87s/it]

Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.74s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.76s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.44s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.89s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.41s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.89s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.43s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.90s/it]

GPU 1:   0%|          | 0/8 [00:00<?, ?it/s]
GPU 2:   0%|          | 0/8 [00:00<?, ?it/s]
GPU 3:   0%|          | 0/8 [00:00<?, ?it/s]
GPU 0:   0%|          | 0/8 [00:00<?, ?it/s]
GPU 1:  12%|â–ˆâ–Ž        | 1/8 [00:01<00:10,  1.48s/it]
GPU 2:  12%|â–ˆâ–Ž        | 1/8 [00:01<00:11,  1.58s/it]
GPU 3:  12%|â–ˆâ–Ž        | 1/8 [00:01<00:10,  1.53s/it]
GPU 0:  12%|â–ˆâ–Ž        | 1/8 [00:01<00:10,  1.55s/it]
GPU 1:  25%|â–ˆâ–ˆâ–Œ       | 2/8 [00:02<00:08,  1.48s/it]
GPU 2:  25%|â–ˆâ–ˆâ–Œ       | 2/8 [00:03<00:09,  1.58s/it]
GPU 3:  25%|â–ˆâ–ˆâ–Œ       | 2/8 [00:03<00:09,  1.51s/it]
GPU 0:  25%|â–ˆâ–ˆâ–Œ       | 2/8 [00:03<00:09,  1.53s/it]
GPU 1:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 3/8 [00:04<00:07,  1.48s/it]
GPU 2:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 3/8 [00:04<00:07,  1.58s/it]
GPU 3:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 3/8 [00:04<00:07,  1.51s/it]
GPU 0:  38%|â–ˆâ–ˆâ–ˆâ–Š      | 3/8 [00:04<00:07,  1.52s/it]
GPU 1:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 4/8 [00:05<00:05,  1.49s/it]
GPU 3:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 4/8 [00:06<00:06,  1.51s/it]
GPU 2:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 4/8 [00:06<00:06,  1.57s/it]
GPU 0:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 4/8 [00:06<00:06,  1.51s/it]
GPU 1:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 5/8 [00:07<00:04,  1.49s/it]
GPU 3:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 5/8 [00:07<00:04,  1.52s/it]
GPU 2:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 5/8 [00:07<00:04,  1.58s/it]
GPU 0:  62%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Ž   | 5/8 [00:07<00:04,  1.53s/it]
GPU 1:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 6/8 [00:08<00:02,  1.46s/it]
GPU 3:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 6/8 [00:09<00:03,  1.53s/it]
GPU 2:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 6/8 [00:09<00:03,  1.58s/it]
GPU 0:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 6/8 [00:09<00:03,  1.53s/it]
GPU 1:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7/8 [00:10<00:01,  1.45s/it]
GPU 3:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7/8 [00:10<00:01,  1.54s/it]
GPU 0:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7/8 [00:10<00:01,  1.54s/it]
GPU 2:  88%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Š | 7/8 [00:11<00:01,  1.59s/it]
GPU 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:11<00:00,  1.44s/it]
GPU 1: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:11<00:00,  1.46s/it]

GPU 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:12<00:00,  1.54s/it]
GPU 3: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:12<00:00,  1.53s/it]

GPU 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:12<00:00,  1.54s/it]
GPU 0: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:12<00:00,  1.54s/it]

GPU 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:12<00:00,  1.60s/it]
GPU 2: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 8/8 [00:12<00:00,  1.59s/it]
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:02<00:06,  2.18s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.42s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.50s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.53s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:05<00:06,  3.12s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.71s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.81s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.83s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:09<00:03,  3.37s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:10<00:00,  2.32s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:10<00:00,  2.58s/it]

Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.53s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.60s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:10<00:03,  3.61s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.32s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.78s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.32s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.81s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.32s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.81s/it]

GPU 1:   0%|          | 0/50 [00:00<?, ?it/s]

  0%|          | 0/20 [00:00<?, ?it/s][A

  5%|â–Œ         | 1/20 [00:00<00:08,  2.15it/s][A

 15%|â–ˆâ–Œ        | 3/20 [00:00<00:02,  5.85it/s][A

 30%|â–ˆâ–ˆâ–ˆ       | 6/20 [00:00<00:01, 10.36it/s][A

 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 9/20 [00:00<00:00, 13.38it/s][A
GPU 2:   0%|          | 0/50 [00:00<?, ?it/s]

  0%|          | 0/20 [00:00<?, ?it/s][A

 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:01<00:00, 15.50it/s][A
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:01<00:00, 10.95it/s]

GPU 1:   0%|          | 0/50 [00:01<?, ?it/s]
Process Process-13:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 298, in ablation_sweep_chunk
    text = model.to_string(output[0])
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 845, in to_string
    tokens = torch.tensor(tokens)
TypeError: new(): invalid data type 'str'

GPU 0:   0%|          | 0/50 [00:00<?, ?it/s]

  0%|          | 0/20 [00:00<?, ?it/s][A

  5%|â–Œ         | 1/20 [00:00<00:08,  2.35it/s][A
GPU 3:   0%|          | 0/50 [00:00<?, ?it/s]

  0%|          | 0/20 [00:00<?, ?it/s][A

 15%|â–ˆâ–Œ        | 3/20 [00:00<00:02,  6.56it/s][A

 30%|â–ˆâ–ˆâ–ˆ       | 6/20 [00:00<00:01, 11.90it/s][A

 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 9/20 [00:00<00:00, 15.65it/s][A

  5%|â–Œ         | 1/20 [00:00<00:07,  2.48it/s][A

  5%|â–Œ         | 1/20 [00:00<00:08,  2.35it/s][A

 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:00<00:00, 18.28it/s][A

 15%|â–ˆâ–Œ        | 3/20 [00:00<00:02,  6.81it/s][A
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:00<00:00, 12.65it/s]

GPU 2:   0%|          | 0/50 [00:00<?, ?it/s]
Process Process-14:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 298, in ablation_sweep_chunk
    text = model.to_string(output[0])
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 845, in to_string
    tokens = torch.tensor(tokens)
TypeError: new(): invalid data type 'str'


 15%|â–ˆâ–Œ        | 3/20 [00:00<00:02,  6.43it/s][A

 30%|â–ˆâ–ˆâ–ˆ       | 6/20 [00:00<00:01, 12.03it/s][A

 30%|â–ˆâ–ˆâ–ˆ       | 6/20 [00:00<00:01, 11.51it/s][A

 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 9/20 [00:00<00:00, 15.63it/s][A

 45%|â–ˆâ–ˆâ–ˆâ–ˆâ–Œ     | 9/20 [00:00<00:00, 15.02it/s][A

 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:00<00:00, 18.10it/s][A
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:00<00:00, 12.74it/s]

GPU 0:   0%|          | 0/50 [00:00<?, ?it/s]
Process Process-12:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 298, in ablation_sweep_chunk
    text = model.to_string(output[0])
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 845, in to_string
    tokens = torch.tensor(tokens)
TypeError: new(): invalid data type 'str'


 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:00<00:00, 17.47it/s][A
 60%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ    | 12/20 [00:00<00:00, 12.22it/s]

GPU 3:   0%|          | 0/50 [00:00<?, ?it/s]
Process Process-15:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 298, in ablation_sweep_chunk
    text = model.to_string(output[0])
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 845, in to_string
    tokens = torch.tensor(tokens)
TypeError: new(): invalid data type 'str'
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")
/home/paperspace/.local/lib/python3.9/site-packages/torch/cuda/__init__.py:829: UserWarning: Can't initialize NVML
  warnings.warn("Can't initialize NVML")

Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.52s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.49s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.56s/it]
Loading checkpoint shards:  25%|â–ˆâ–ˆâ–Œ       | 1/4 [00:03<00:10,  3.36s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.88s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.91s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.94s/it]
Loading checkpoint shards:  50%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ     | 2/4 [00:07<00:07,  3.87s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.89s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.90s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.94s/it]
Loading checkpoint shards:  75%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ  | 3/4 [00:11<00:03,  3.89s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.53s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.00s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.53s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.00s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.47s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:11<00:00,  2.95s/it]

Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  2.55s/it]
Loading checkpoint shards: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 4/4 [00:12<00:00,  3.03s/it]

GPU 1 - Layers:   0%|          | 0/3 [00:00<?, ?it/s]
GPU 1 - Layers:   0%|          | 0/3 [00:00<?, ?it/s]
Process Process-18:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 393, in path_patch_heads
    model.add_hook(f"blocks.{layer}.attn.hook_result", patch_head)
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/hook_points.py", line 295, in add_hook
    self.check_and_add_hook(
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/hook_points.py", line 259, in check_and_add_hook
    self.check_hooks_to_add(
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 248, in check_hooks_to_add
    assert (
AssertionError: Cannot add hook blocks.13.attn.hook_result if use_attn_result_hook is False

GPU 0 - Layers:   0%|          | 0/3 [00:00<?, ?it/s]
GPU 0 - Layers:   0%|          | 0/3 [00:00<?, ?it/s]
Process Process-17:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 393, in path_patch_heads
    model.add_hook(f"blocks.{layer}.attn.hook_result", patch_head)
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/hook_points.py", line 295, in add_hook
    self.check_and_add_hook(
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/hook_points.py", line 259, in check_and_add_hook
    self.check_hooks_to_add(
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 248, in check_hooks_to_add
    assert (
AssertionError: Cannot add hook blocks.7.attn.hook_result if use_attn_result_hook is False

GPU 2 - Layers:   0%|          | 0/2 [00:00<?, ?it/s]
GPU 2 - Layers:   0%|          | 0/2 [00:00<?, ?it/s]
Process Process-19:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 393, in path_patch_heads
    model.add_hook(f"blocks.{layer}.attn.hook_result", patch_head)
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/hook_points.py", line 295, in add_hook
    self.check_and_add_hook(
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/hook_points.py", line 259, in check_and_add_hook
    self.check_hooks_to_add(
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 248, in check_hooks_to_add
    assert (
AssertionError: Cannot add hook blocks.28.attn.hook_result if use_attn_result_hook is False

GPU 3 - Layers:   0%|          | 0/2 [00:00<?, ?it/s]
GPU 3 - Layers:   0%|          | 0/2 [00:00<?, ?it/s]
Process Process-20:
Traceback (most recent call last):
  File "/usr/lib/python3.9/multiprocessing/process.py", line 315, in _bootstrap
    self.run()
  File "/usr/lib/python3.9/multiprocessing/process.py", line 108, in run
    self._target(*self._args, **self._kwargs)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 393, in path_patch_heads
    model.add_hook(f"blocks.{layer}.attn.hook_result", patch_head)
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/hook_points.py", line 295, in add_hook
    self.check_and_add_hook(
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/hook_points.py", line 259, in check_and_add_hook
    self.check_hooks_to_add(
  File "/home/paperspace/.local/lib/python3.9/site-packages/transformer_lens/HookedTransformer.py", line 248, in check_hooks_to_add
    assert (
AssertionError: Cannot add hook blocks.30.attn.hook_result if use_attn_result_hook is False
Traceback (most recent call last):
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 584, in <module>
    main()
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 548, in main
    generate_summary(all_results)
  File "/home/paperspace/dev/MATS/multi/main_experiments.py", line 559, in generate_summary
    - Counting bug: {results['positive_controls'][0]['is_fixed']}
IndexError: list index out of range
